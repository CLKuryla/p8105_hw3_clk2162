---
title: "P8105 Homework 3"
author: "Christine Lucille Kuryla (clk2162)"
date: "2023-10-14"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
```

# Problem 1

Load data

```{r}
library(p8105.datasets)
data("instacart")
```

Explore and describe dataset.

The goal is to do some exploration of this dataset. To that end, write a short description of the dataset, noting the size and structure of the data, describing some key variables, and giving illstrative examples of observations.

```{r}

# Check out the structure of the data set 
head(instacart)

```

This dataset has `r nrow(instacart)` rows and `r ncol(instacart)` columns. The column names are `r colnames(instacart)`. It is in a long format, and the order_id is not distinct. Each row in the datas et represents a particular item purchased and contains corresponding information about it. There are `r instacart %>% select(order_id) %>% n_distinct()` distinct orders, `r instacart %>% select(user_id) %>% n_distinct()` users (so it seems to be one order per user), containing a total of `r instacart %>% select(product_id) %>% n_distinct()` products.

```{r}

# aisles and number of times they occur (number of times there is an order from the aisle)
# arrange with most ordered from aisles at the top
aisles_df <- instacart %>%
  count(aisle) %>% 
  arrange(desc(n))

head(aisles_df)

```


There are `r nrow(aisles_df)` aisles. The aisles most ordered from are:

```{r aisles_most_orders, echo = FALSE}

aisles_most_orders <- head(aisles_df %>% select("aisle"), n=10)

knitr::kable(aisles_most_orders)

```

```{r instacart_aisle_plot}

aisles_df %>%
  filter(n > 10000) %>% 
  mutate(aisle = fct_reorder(aisle, n)) %>% 
  ggplot(aes(x = aisle, y = n)) +
  geom_point() +
  labs(title = "Number of items ordered in each aisle",
       y = "number of items ordered") +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

instacart %>% 
    filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
      group_by(aisle) %>% 
    count(product_name) |> 
    mutate(rank = min_rank(desc(n))) %>% 
    filter(rank < 4) %>% 
    arrange(desc(n)) %>% 
    knitr::kable()
  

```


